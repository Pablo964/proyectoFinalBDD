CREATE OR REPLACE PACKAGE PARAGON.GESTION
IS
    PROCEDURE MADRE(CUR_GLOBAL OUT SYS_REFCURSOR, OPCION VARCHAR2, HE_ID NUMBER,
                    VELOCIDAD NUMBER, CURA NUMBER, DANYO NUMBER, NOM_HEROE VARCHAR2);
END;

CREATE OR REPLACE PACKAGE BODY PARAGON.GESTION
IS
    PROCEDURE ACTUALIZAR(HE_ID NUMBER, VELOCIDAD NUMBER, CURA NUMBER, 
    DANYO NUMBER, NOM_HEROE VARCHAR2)
    IS
    BEGIN
        UPDATE HABILIDADES_ESPECIALES HE
        SET HE.P_VELOCIDAD_HABILIDAD = VELOCIDAD, HE.P_CURA_HABILIDAD = CURA,
        HE.P_DANYO_HABILIDAD = DANYO, HE.NOMBRE_HEROE_HABILIDAD = NOM_HEROE
        WHERE HE.ID_HABILIDAD_ESPECIAL = HE_ID;
    END;
    PROCEDURE GRABAR(HE_ID NUMBER, VELOCIDAD NUMBER, CURA NUMBER, 
    DANYO NUMBER, NOM_HEROE VARCHAR2)
    IS
    BEGIN
        INSERT INTO HABILIDADES_ESPECIALES HE 
        (HE.ID_HABILIDAD_ESPECIAL, HE.NOMBRE_HEROE_HABILIDAD, HE.P_CURA_HABILIDAD, 
        HE.P_DANYO_HABILIDAD, HE.P_VELOCIDAD_HABILIDAD)
        VALUES
        (HE_ID, NOM_HEROE, VELOCIDAD, CURA, DANYO);
        
        EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
                ACTUALIZAR(HE_ID, VELOCIDAD, CURA, DANYO, NOM_HEROE);
            WHEN OTHERS THEN
                RAISE_APPLICATION_ERROR(-20100, 'NO EXISTE EL HÉROE PARA EL QUE QUIERES ASIGNAR LA HABILIDAD');
    END;
    
    PROCEDURE MADRE(CUR_GLOBAL OUT SYS_REFCURSOR, OPCION VARCHAR2, HE_ID NUMBER,
    VELOCIDAD NUMBER, CURA NUMBER, DANYO NUMBER, NOM_HEROE VARCHAR2)
    IS
    BEGIN
        CASE
            WHEN OPCION = 'GRABAR' THEN
                GRABAR(HE_ID, VELOCIDAD, CURA, DANYO, NOM_HEROE);
        END CASE;
    END;
END GESTION;




